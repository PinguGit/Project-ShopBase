from functions import db_connect

def create_user(user_type, user_id, name, street, houseNumber, email, ort_id, laender_id, password_id, forename=None, birthday=None):
    conn = db_connect()
    cursor = conn.cursor()

    if user_type == "vendor":
        # SQL Query to insert into the vendor table
        query = """
            INSERT INTO vendor (vendor_id, name, street, houseNumber, email, ort_id, laender_id, password_id)
            VALUES (%s, %s, %s, %s, %s, %s, %s, %s)
        """
        cursor.execute(query, (user_id, name, street, houseNumber, email, ort_id, laender_id, password_id))

    elif user_type == "customer":
        # SQL Query to insert into the customer table
        query = """
            INSERT INTO customer (customer_id, forename, birthday, name, street, houseNumber, email, ort_id, laender_id, password_id)
            VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s)
        """
        cursor.execute(query, (user_id, forename, birthday, name, street, houseNumber, email, ort_id, laender_id, password_id))

    else:
        raise ValueError("Invalid user_type. Must be 'vendor' or 'customer'.")

    conn.commit()  
    conn.close()

# Example usage
create_user('vendor', 1, 'Vendor Name', 'Street', '42', 'vendor@example.com', 1001, 1, 1234)
create_user('customer', 2, 'Customer Name', 'Street', '43', 'customer@example.com', 1002, 2, 1235, 'John', '1990-01-01')
